{"title":"JDBC基础知识","date":"2021-06-09T02:27:13.000Z","date_formatted":{"ll":"Jun 9, 2021","L":"06/09/2021","MM-DD":"06-09"},"link":"2021/06/08/JDBC基础知识","comments":true,"tags":["JDBC"],"categories":["数据库"],"updated":"2021-06-09T10:46:01.913Z","content":"<blockquote>\n<p>JDBC链接数据库，是深入底层进行学习的基础</p>\n</blockquote>\n<p>下面将使用代码从如何构建数据库链接等一个个方面，带大家深入走入JDBC的世界</p>\n<h2 id=\"1.-jdbc使用方法六步\">1. JDBC使用方法六步<a title=\"#1.-jdbc使用方法六步\" href=\"#1.-jdbc使用方法六步\"></a></h2>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2020/11/24</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    JDBC编程六步</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCTest01</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        Statement stmt = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//1.注册驱动</span></span><br><span class=\"line\">            Driver driver = <span class=\"keyword\">new</span> com.mysql.jdbc.Driver();    <span class=\"comment\">//多态，父类性引用指向子类型对象</span></span><br><span class=\"line\">            DriverManager.registerDriver(driver);</span><br><span class=\"line\">            <span class=\"comment\">// Driver driver = new oracle.jdbc.driver.OracleDriver();   // oracle驱动</span></span><br><span class=\"line\">            <span class=\"comment\">//2.获取连接</span></span><br><span class=\"line\">            <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">                URL：统一资源定位符（网络中某个资源的绝对路径）</span></span><br><span class=\"line\"><span class=\"comment\">                http://www.baidu.com/ 这就是URL</span></span><br><span class=\"line\"><span class=\"comment\">                URL包括几部分？</span></span><br><span class=\"line\"><span class=\"comment\">                    协议</span></span><br><span class=\"line\"><span class=\"comment\">                    IP</span></span><br><span class=\"line\"><span class=\"comment\">                    PORT</span></span><br><span class=\"line\"><span class=\"comment\">                    资源名</span></span><br><span class=\"line\"><span class=\"comment\">                http://182.61.200.7:80/index.html</span></span><br><span class=\"line\"><span class=\"comment\">                    http:// 通信协议</span></span><br><span class=\"line\"><span class=\"comment\">                    182.61.200.7  服务器IP地址</span></span><br><span class=\"line\"><span class=\"comment\">                    80 服务器上软件的端口号</span></span><br><span class=\"line\"><span class=\"comment\">                    index.html 是服务器上某个资源名</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">                jdbc:mysql://127.0.0.1:3306/bjpowernode</span></span><br><span class=\"line\"><span class=\"comment\">                    jdbc:mysql://   协议</span></span><br><span class=\"line\"><span class=\"comment\">                    127.0.0.1   IP地址</span></span><br><span class=\"line\"><span class=\"comment\">                    3306    mysql数据库端口号</span></span><br><span class=\"line\"><span class=\"comment\">                    bjpowernode 具体的数据库实例名</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">                什么是通信协议，有什么用？</span></span><br><span class=\"line\"><span class=\"comment\">                    通信协议实在通信之前就提前定好的数据传送格式。</span></span><br><span class=\"line\"><span class=\"comment\">                    数据包具体怎么传数据，格式提前定好的。</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">                oracle的URL：</span></span><br><span class=\"line\"><span class=\"comment\">                    jdbc:oracle:thin:@localhost:1521:orcl</span></span><br><span class=\"line\"><span class=\"comment\">             */</span></span><br><span class=\"line\">            String url = <span class=\"string\">&quot;jdbc:mysql://127.0.0.1:3306/bjpowernode&quot;</span>;</span><br><span class=\"line\">            String user = <span class=\"string\">&quot;root&quot;</span>;</span><br><span class=\"line\">            String password = <span class=\"string\">&quot;991229&quot;</span>;</span><br><span class=\"line\">            conn = DriverManager.getConnection(url,user,password);</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;数据库连接对象 = &quot;</span> + conn);</span><br><span class=\"line\">            <span class=\"comment\">//3.获取数据库操作对象</span></span><br><span class=\"line\">            stmt = conn.createStatement();</span><br><span class=\"line\">            <span class=\"comment\">//4.执行sql</span></span><br><span class=\"line\">            String sql = <span class=\"string\">&quot;insert into dept(deptno,dname,loc) values(50,&#x27;人事部&#x27;,&#x27;北京&#x27;)&quot;</span>;</span><br><span class=\"line\">            <span class=\"comment\">//专门执行DML语句的(insert delete update)</span></span><br><span class=\"line\">            <span class=\"comment\">//返回值是“影响数据库中的记录条数”</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> count = stmt.executeUpdate(sql);</span><br><span class=\"line\">            System.out.println(count == <span class=\"number\">1</span> ? <span class=\"string\">&quot;保存成功&quot;</span> : <span class=\"string\">&quot;保存失败&quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">//5.处理查询结果集</span></span><br><span class=\"line\"></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;<span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//6.释放资源</span></span><br><span class=\"line\">            <span class=\"comment\">// 为了保证资源一定释放，在finally语句块中关闭资源</span></span><br><span class=\"line\">            <span class=\"comment\">// 并且要遵循从小到大依次关闭</span></span><br><span class=\"line\">            <span class=\"comment\">// 分别对其try,catch</span></span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(stmt != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    stmt.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(conn != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    conn.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;<span class=\"keyword\">catch</span> (SQLException e)&#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.mysql.jdbc.Driver;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.DriverManager;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Statement;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2020/11/24</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCTest02</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        Statement stmt = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">//1.注册驱动</span></span><br><span class=\"line\">            DriverManager.registerDriver(<span class=\"keyword\">new</span> com.mysql.jdbc.Driver());</span><br><span class=\"line\">            <span class=\"comment\">//2.获取链接</span></span><br><span class=\"line\">            conn = DriverManager.getConnection(<span class=\"string\">&quot;jdbc:mysql://127.0.0.1:3306/bjpowernode&quot;</span>,</span><br><span class=\"line\">                                                         <span class=\"string\">&quot;root&quot;</span>,</span><br><span class=\"line\">                                                     <span class=\"string\">&quot;991229&quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">//3.获取数据库操作对象</span></span><br><span class=\"line\">            stmt = conn.createStatement();</span><br><span class=\"line\">            <span class=\"comment\">//4.执行SQL语句</span></span><br><span class=\"line\">            <span class=\"comment\">// JDBC的sql语句不用写分号</span></span><br><span class=\"line\">            String sql = <span class=\"string\">&quot;delete from dept where deptno = 40&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> count = stmt.executeUpdate(sql);</span><br><span class=\"line\">            System.out.println(count == <span class=\"number\">1</span> ? <span class=\"string\">&quot;删除成功&quot;</span> : <span class=\"string\">&quot;删除失败&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;<span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//6.释放资源</span></span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(stmt != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    stmt.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(conn != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    conn.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"2.实现注册的另一个方法\">2.实现注册的另一个方法<a title=\"#2.实现注册的另一个方法\" href=\"#2.实现注册的另一个方法\"></a></h2>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.DriverManager;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Statement;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2020/11/24</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    注册驱动的另一种方式（这种方式常用）</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCTest03</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        Statement stmt = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//1.注册驱动</span></span><br><span class=\"line\">            <span class=\"comment\">// 这个是注册驱动的第一种写法</span></span><br><span class=\"line\">            <span class=\"comment\">//DriverManager.registerDriver(new com.mysql.jdbc.Driver());</span></span><br><span class=\"line\">            <span class=\"comment\">//注册驱动的第二种方式：常用的</span></span><br><span class=\"line\">            <span class=\"comment\">//为什么这种方式常用：因为参数是字符串，字符串可以写到xxx.properties文件中。</span></span><br><span class=\"line\">            <span class=\"comment\">//以下方法不需要接收返回值，因为只想要他的类加载功能</span></span><br><span class=\"line\">            Class.forName(<span class=\"string\">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">//2.获取链接</span></span><br><span class=\"line\">            conn = DriverManager.getConnection(<span class=\"string\">&quot;jdbc:mysql://127.0.0.1:3306/bjpowernode&quot;</span>, <span class=\"string\">&quot;root&quot;</span>, <span class=\"string\">&quot;991229&quot;</span>);</span><br><span class=\"line\">            System.out.println(conn);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p>为何使用反射机制可以实现注册呢？</p>\n<blockquote>\n<p>因为反射机制可以实现类加载</p>\n<p>而static{}代码块会在类加载的时候运行，Driver的源代码为</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">// Source code recreated from a .class file by IntelliJ IDEA</span></span><br><span class=\"line\"><span class=\"comment\">// (powered by Fernflower decompiler)</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">package</span> com.mysql.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.DriverManager;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Driver</span> <span class=\"keyword\">extends</span> <span class=\"title\">NonRegisteringDriver</span> <span class=\"keyword\">implements</span> <span class=\"title\">java</span>.<span class=\"title\">sql</span>.<span class=\"title\">Driver</span> </span>&#123;</span><br><span class=\"line\"> <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Driver</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> SQLException </span>&#123;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">     <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">         DriverManager.registerDriver(<span class=\"keyword\">new</span> Driver());</span><br><span class=\"line\">     &#125; <span class=\"keyword\">catch</span> (SQLException var1) &#123;</span><br><span class=\"line\">         <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> RuntimeException(<span class=\"string\">&quot;Can&#x27;t register driver!&quot;</span>);</span><br><span class=\"line\">     &#125;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>说明可以使用反射机制实现类加载</p>\n</blockquote>\n</li>\n</ul>\n<h2 id=\"3.将连接数据库的所有信息都配置到配置文件中\">3.将连接数据库的所有信息都配置到配置文件中<a title=\"#3.将连接数据库的所有信息都配置到配置文件中\" href=\"#3.将连接数据库的所有信息都配置到配置文件中\"></a></h2>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.DriverManager;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Statement;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ResourceBundle;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2020/11/24</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"comment\">//将连接数据库的所有信息都配置到配置文件中</span></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    实际开发中不建议把连接数据库的信息写死到java程序中</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCTest04</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//使用资源绑定器绑定属性配置文件</span></span><br><span class=\"line\">        ResourceBundle bundle = ResourceBundle.getBundle(<span class=\"string\">&quot;com.bjpowernode.jdbc.jdbc&quot;</span>);</span><br><span class=\"line\">        String driver = bundle.getString(<span class=\"string\">&quot;driver&quot;</span>);</span><br><span class=\"line\">        String url = bundle.getString(<span class=\"string\">&quot;url&quot;</span>);</span><br><span class=\"line\">        String user = bundle.getString(<span class=\"string\">&quot;user&quot;</span>);</span><br><span class=\"line\">        String password = bundle.getString(<span class=\"string\">&quot;password&quot;</span>);</span><br><span class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        Statement stmt = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">//1.注册驱动</span></span><br><span class=\"line\">            Class.forName(driver);</span><br><span class=\"line\">            <span class=\"comment\">//2.获取链接</span></span><br><span class=\"line\">            conn = DriverManager.getConnection(url, user, password);</span><br><span class=\"line\">            <span class=\"comment\">//3.获取数据库操作对象</span></span><br><span class=\"line\">            stmt = conn.createStatement();</span><br><span class=\"line\">            <span class=\"comment\">//4.执行SQL语句</span></span><br><span class=\"line\">            <span class=\"comment\">// JDBC的sql语句不用写分号</span></span><br><span class=\"line\">            String sql = <span class=\"string\">&quot;update dept set dname = &#x27;销售部&#x27;,loc = &#x27;天津&#x27; where deptno = 20&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> count = stmt.executeUpdate(sql);</span><br><span class=\"line\">            System.out.println(count == <span class=\"number\">1</span> ? <span class=\"string\">&quot;添加成功&quot;</span> : <span class=\"string\">&quot;添加失败&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SQLException | ClassNotFoundException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;<span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//6.释放资源</span></span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(stmt != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    stmt.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(conn != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    conn.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>jdbc.properties</li>\n</ul>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">driver</span>=<span class=\"string\">com.mysql.jdbc.Driver</span></span><br><span class=\"line\"><span class=\"attr\">url</span>=<span class=\"string\">jdbc:mysql://127.0.0.1:3306/bjpowernode</span></span><br><span class=\"line\"><span class=\"attr\">user</span>=<span class=\"string\">root</span></span><br><span class=\"line\"><span class=\"attr\">password</span>=<span class=\"string\">991229</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"4.-查询数据库数据\">4. 查询数据库数据<a title=\"#4.-查询数据库数据\" href=\"#4.-查询数据库数据\"></a></h2>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ResourceBundle;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2020/11/25</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCTest05</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        ResourceBundle rb = ResourceBundle.getBundle(<span class=\"string\">&quot;com.bjpowernode.jdbc.jdbc&quot;</span>);</span><br><span class=\"line\">        String driver = rb.getString(<span class=\"string\">&quot;driver&quot;</span>);</span><br><span class=\"line\">        String url = rb.getString(<span class=\"string\">&quot;url&quot;</span>);</span><br><span class=\"line\">        String user = rb.getString(<span class=\"string\">&quot;user&quot;</span>);</span><br><span class=\"line\">        String password = rb.getString(<span class=\"string\">&quot;password&quot;</span>);</span><br><span class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        Statement stmt = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        ResultSet rs = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 1.注册驱动</span></span><br><span class=\"line\">            Class.forName(driver);</span><br><span class=\"line\">            <span class=\"comment\">// 2. 建立连接</span></span><br><span class=\"line\">            conn = DriverManager.getConnection(url,user,password);</span><br><span class=\"line\">            <span class=\"comment\">// 3.获取数据库操作对象</span></span><br><span class=\"line\">            stmt = conn.createStatement();</span><br><span class=\"line\">            <span class=\"comment\">// 4.执行sql语句</span></span><br><span class=\"line\">            String sql = <span class=\"string\">&quot;select empno,ename,sal from emp&quot;</span>;</span><br><span class=\"line\">            rs = stmt.executeQuery(sql);</span><br><span class=\"line\">            <span class=\"comment\">// 5.处理查询结果集</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(rs.next())&#123;</span><br><span class=\"line\">                <span class=\"comment\">//光标指向的行有数据</span></span><br><span class=\"line\">                <span class=\"comment\">//取数据</span></span><br><span class=\"line\">                <span class=\"comment\">//getString : 不管数据库中的数据类型是什么，都以String的形式取出</span></span><br><span class=\"line\">                <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">                String empno = rs.getString(1); //JDBC中所有的下标从1开始，不是从0开始</span></span><br><span class=\"line\"><span class=\"comment\">                String ename = rs.getString(2);</span></span><br><span class=\"line\"><span class=\"comment\">                String sal = rs.getString(3);</span></span><br><span class=\"line\"><span class=\"comment\">                */</span></span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">                //这个不是以列的下标获取，以列的名字获取</span></span><br><span class=\"line\"><span class=\"comment\">                String empno = rs.getString(&quot;empno&quot;);   //重点注意：列名称不是表中的列名称，是查询结果集的列名称</span></span><br><span class=\"line\"><span class=\"comment\">                String ename = rs.getString(&quot;ename&quot;);</span></span><br><span class=\"line\"><span class=\"comment\">                String sal = rs.getString(&quot;sal&quot;);</span></span><br><span class=\"line\"><span class=\"comment\">                System.out.printf(empno + &quot;\\t|  &quot; + ename + &quot; \\t|  &quot; + sal + &quot;\\n&quot;);</span></span><br><span class=\"line\"><span class=\"comment\">                */</span></span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">//除了可以以String类型取出之外，还可以以特定的类型取出</span></span><br><span class=\"line\">                <span class=\"keyword\">int</span> empno = rs.getInt(<span class=\"number\">1</span>);</span><br><span class=\"line\">                String ename = rs.getString(<span class=\"number\">2</span>);</span><br><span class=\"line\">                <span class=\"keyword\">double</span> sal = rs.getDouble(<span class=\"number\">3</span>);</span><br><span class=\"line\">                System.out.println(empno + <span class=\"string\">&quot;\\t|  &quot;</span> + ename + <span class=\"string\">&quot; \\t|  &quot;</span> + (sal+<span class=\"number\">100</span>) + <span class=\"string\">&quot;\\n&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(rs != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    rs.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(stmt != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    stmt.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(conn != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    conn.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"5.mysql注入问题\">5.Mysql注入问题<a title=\"#5.mysql注入问题\" href=\"#5.mysql注入问题\"></a></h2>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.HashMap;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Map;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Scanner;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2020/11/24</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    实现功能：</span></span><br><span class=\"line\"><span class=\"comment\">        1.需求：模拟用户登录功能的实现</span></span><br><span class=\"line\"><span class=\"comment\">        2.业务逻辑：</span></span><br><span class=\"line\"><span class=\"comment\">            程序运行的时候，提供一个输入的入口，可以让用户输入用户的账户密码</span></span><br><span class=\"line\"><span class=\"comment\">            用户输入用户名和密码之后，提交信息，java程序收集到用户信息</span></span><br><span class=\"line\"><span class=\"comment\">            java程序连接数据库验证用户名和密码是否合适</span></span><br><span class=\"line\"><span class=\"comment\">            合法：显示登陆成功</span></span><br><span class=\"line\"><span class=\"comment\">            不合法：显示登陆失败</span></span><br><span class=\"line\"><span class=\"comment\">        3.数据的准备</span></span><br><span class=\"line\"><span class=\"comment\">            在实际的开发中，表的设计会使用专业的建模工具，我们这里安装一个建模工具：PowerDesigner</span></span><br><span class=\"line\"><span class=\"comment\">            使用PD工具来进行数据库表的设计（参见login-user.sql）</span></span><br><span class=\"line\"><span class=\"comment\">        4.当前程序存在的问题：</span></span><br><span class=\"line\"><span class=\"comment\">            用户名： fdsa</span></span><br><span class=\"line\"><span class=\"comment\">            密码： fdsa&#x27; or &#x27;1&#x27;=&#x27;1</span></span><br><span class=\"line\"><span class=\"comment\">            登陆成功</span></span><br><span class=\"line\"><span class=\"comment\">            这种现象被称为SQL注入（安全隐患）。（黑客经常使用）</span></span><br><span class=\"line\"><span class=\"comment\">        5.导致SQL注入的根本原因是什么？</span></span><br><span class=\"line\"><span class=\"comment\">            用户输入的信息中含有sql语句的关键字，并且这些关键字参与了sql语句的编译过程，</span></span><br><span class=\"line\"><span class=\"comment\">            导致了sql语句的原意被扭曲，从而导致sql注入。</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCTest06</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 初始化一个界面</span></span><br><span class=\"line\">        Map&lt;String,String&gt; userLoginInfo = initUI();</span><br><span class=\"line\">        <span class=\"comment\">// 验证用户名和密码</span></span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> loginSuccess = login(userLoginInfo);</span><br><span class=\"line\">        <span class=\"comment\">// 最后输出结果</span></span><br><span class=\"line\">        System.out.print(loginSuccess ? <span class=\"string\">&quot;登陆成功&quot;</span> : <span class=\"string\">&quot;登录失败&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 用户登录</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> userLoginInfo 用户登录信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span>  false表示失败 ， true表示成功</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">login</span><span class=\"params\">(Map&lt;String, String&gt; userLoginInfo)</span> </span>&#123;</span><br><span class=\"line\">        String loginName = userLoginInfo.get(<span class=\"string\">&quot;loginName&quot;</span>) ;</span><br><span class=\"line\">        String loginPwd = userLoginInfo.get(<span class=\"string\">&quot;loginPwd&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> loginSuccess = <span class=\"keyword\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// JDBC代码</span></span><br><span class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        Statement stmt = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        ResultSet rs = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 1.注册驱动</span></span><br><span class=\"line\">            Class.forName(<span class=\"string\">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 2.获取连接</span></span><br><span class=\"line\">            conn = DriverManager.getConnection(<span class=\"string\">&quot;jdbc:mysql://127.0.0.1:3306/bjpowernode&quot;</span>,<span class=\"string\">&quot;root&quot;</span>,<span class=\"string\">&quot;991229&quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 3.获取数据库操作对象</span></span><br><span class=\"line\">            stmt = conn.createStatement();</span><br><span class=\"line\">            <span class=\"comment\">// 4.执行sql</span></span><br><span class=\"line\">            String sql = <span class=\"string\">&quot;select * from t_user where loginName =&#x27;&quot;</span> + loginName + <span class=\"string\">&quot;&#x27; and loginPwd = &quot;</span> + <span class=\"string\">&quot;&#x27;&quot;</span> + loginPwd + <span class=\"string\">&quot;&#x27;&quot;</span>;</span><br><span class=\"line\">            <span class=\"comment\">//以上正好完成了sql语句的拼接，以下代码的含义是，发送sql语句给DBMS，DBMS进行sql编译</span></span><br><span class=\"line\">            <span class=\"comment\">//正好将用户提供的“非法信息”编译进去，导致原sql语句的含义被扭曲了</span></span><br><span class=\"line\">            rs = stmt.executeQuery(sql);</span><br><span class=\"line\">            <span class=\"comment\">// 5.处理查询结果集</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span>(rs.next())&#123;</span><br><span class=\"line\">                loginSuccess = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// 6.释放资源</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(rs != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    rs.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(stmt != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    stmt.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(conn != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    conn.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> loginSuccess;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 初始化用户界面</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span>  用户输入的用户名和密码等登录信息</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Map&lt;String, String&gt; <span class=\"title\">initUI</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        Scanner s = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.print(<span class=\"string\">&quot;用户名： &quot;</span>);</span><br><span class=\"line\">        String loginName = s.nextLine();</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.print(<span class=\"string\">&quot;密码： &quot;</span>);</span><br><span class=\"line\">        String loginPwd = s.nextLine();</span><br><span class=\"line\"></span><br><span class=\"line\">        Map&lt;String,String&gt; userLoginInfo = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">        userLoginInfo.put(<span class=\"string\">&quot;loginName&quot;</span>,loginName);</span><br><span class=\"line\">        userLoginInfo.put(<span class=\"string\">&quot;loginPwd&quot;</span>,loginPwd);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> userLoginInfo;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"6.-解决mysql注入问题,preparestatement\">6. 解决mysql注入问题,prepareStatement<a title=\"#6.-解决mysql注入问题,preparestatement\" href=\"#6.-解决mysql注入问题,preparestatement\"></a></h2>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.HashMap;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Map;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Scanner;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2020/11/27</span></span><br><span class=\"line\"><span class=\"comment\"> * 1.解决SQL注入问题</span></span><br><span class=\"line\"><span class=\"comment\"> *      只要用户提供的信息不参与SQL语句的编译过程，问题就解决了</span></span><br><span class=\"line\"><span class=\"comment\"> *      即使用户提供的信息中含有SQL语句的关键字，但是没有参与编译，不起作用。</span></span><br><span class=\"line\"><span class=\"comment\"> *      要想用户信息不参与SQL语句的编译，那么必须使用java.sql.PreparedStatement</span></span><br><span class=\"line\"><span class=\"comment\"> *      PreparedStatement接口继承了java.sql.Statement</span></span><br><span class=\"line\"><span class=\"comment\"> *      PreparedStatement是属于预编译的数据库操作对象</span></span><br><span class=\"line\"><span class=\"comment\"> *      PreparedStatement的原理是：预先对SQL语句的框架进行编译，然后再给SQL语句传“值”</span></span><br><span class=\"line\"><span class=\"comment\"> * 2.测试结果：</span></span><br><span class=\"line\"><span class=\"comment\"> *      用户名：fads</span></span><br><span class=\"line\"><span class=\"comment\"> *      密码：fdas&#x27; or &#x27;1&#x27;=&#x27;1</span></span><br><span class=\"line\"><span class=\"comment\"> *      登陆失败</span></span><br><span class=\"line\"><span class=\"comment\"> * 3.解决SQL注入的关键是什么？</span></span><br><span class=\"line\"><span class=\"comment\"> *      用户的信息中含有sql语句的关键字，但是这些关键字并没有参与编译不起作用</span></span><br><span class=\"line\"><span class=\"comment\"> * 4.对比：Statement和PreparedStatement?</span></span><br><span class=\"line\"><span class=\"comment\"> *      -Statement存在sql注入问题，PreparedStatement解决了sql注入问题</span></span><br><span class=\"line\"><span class=\"comment\"> *      -Statement是编译一次执行一次，PreparedStatement是编译一次执行N次，PreparedStatement效率高一些</span></span><br><span class=\"line\"><span class=\"comment\"> *      -PreparedStatement会在编译阶段，做类型的安全检查</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> *      综上所述，PreparedStatement使用比较多，只有极少数的情况下需要使用Statement</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * 5.什么情况下必须使用Statement呢？</span></span><br><span class=\"line\"><span class=\"comment\"> *      业务方面需要使用sql注入机制</span></span><br><span class=\"line\"><span class=\"comment\"> *      Statement支持SQL注入，凡是业务方面需要使用sql注入的都需要使用Statement</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCTest07</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 初始化一个界面</span></span><br><span class=\"line\">        Map&lt;String,String&gt; userLoginInfo = initUI();</span><br><span class=\"line\">        <span class=\"comment\">// 验证用户名和密码</span></span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> loginSuccess = login(userLoginInfo);</span><br><span class=\"line\">        <span class=\"comment\">// 最后输出结果</span></span><br><span class=\"line\">        System.out.print(loginSuccess ? <span class=\"string\">&quot;登陆成功&quot;</span> : <span class=\"string\">&quot;登录失败&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 用户登录</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> userLoginInfo 用户登录信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span>  false表示失败 ， true表示成功</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">login</span><span class=\"params\">(Map&lt;String, String&gt; userLoginInfo)</span> </span>&#123;</span><br><span class=\"line\">        String loginName = userLoginInfo.get(<span class=\"string\">&quot;loginName&quot;</span>) ;</span><br><span class=\"line\">        String loginPwd = userLoginInfo.get(<span class=\"string\">&quot;loginPwd&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> loginSuccess = <span class=\"keyword\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// JDBC代码</span></span><br><span class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        PreparedStatement ps = <span class=\"keyword\">null</span>;    <span class=\"comment\">//这里使用PreparedStatement（预编译的数据库操作对象）</span></span><br><span class=\"line\">        ResultSet rs = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 1.注册驱动</span></span><br><span class=\"line\">            Class.forName(<span class=\"string\">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 2.获取连接</span></span><br><span class=\"line\">            conn = DriverManager.getConnection(<span class=\"string\">&quot;jdbc:mysql://127.0.0.1:3306/bjpowernode&quot;</span>,<span class=\"string\">&quot;root&quot;</span>,<span class=\"string\">&quot;991229&quot;</span>);</span><br><span class=\"line\">             <span class=\"comment\">// 3.获取预编译的数据库操作对象</span></span><br><span class=\"line\">            <span class=\"comment\">// SQL语句的框子。其中一个?,表示一个占位符，一个？将来接收一个“值”，注意：占位符不能使用单引号括起来</span></span><br><span class=\"line\">            String sql = <span class=\"string\">&quot;select * from t_user where loginName = ? and loginPwd = ? &quot;</span>;</span><br><span class=\"line\">            <span class=\"comment\">// 程序执行到此处，会发送sql语句框子给DBMS，然后DBMS进行sql语句的预先编译。</span></span><br><span class=\"line\">            ps = conn.prepareStatement(sql);</span><br><span class=\"line\">            <span class=\"comment\">// 给占位符?传值（第一个?下标是1，第二个?下标是2,JDBC中所有下标从1开始。）</span></span><br><span class=\"line\">            ps.setString(<span class=\"number\">1</span>,loginName);</span><br><span class=\"line\">            ps.setString(<span class=\"number\">2</span>,loginPwd);</span><br><span class=\"line\">            <span class=\"comment\">// 4.执行sql</span></span><br><span class=\"line\">            rs = ps.executeQuery();</span><br><span class=\"line\">            <span class=\"comment\">// 5.处理查询结果集</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span>(rs.next())&#123;</span><br><span class=\"line\">                loginSuccess = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// 6.释放资源</span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(rs != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    rs.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(ps != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    ps.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(conn != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    conn.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> loginSuccess;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 初始化用户界面</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span>  用户输入的用户名和密码等登录信息</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Map&lt;String, String&gt; <span class=\"title\">initUI</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        Scanner s = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.print(<span class=\"string\">&quot;用户名： &quot;</span>);</span><br><span class=\"line\">        String loginName = s.nextLine();</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.print(<span class=\"string\">&quot;密码： &quot;</span>);</span><br><span class=\"line\">        String loginPwd = s.nextLine();</span><br><span class=\"line\"></span><br><span class=\"line\">        Map&lt;String,String&gt; userLoginInfo = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">        userLoginInfo.put(<span class=\"string\">&quot;loginName&quot;</span>,loginName);</span><br><span class=\"line\">        userLoginInfo.put(<span class=\"string\">&quot;loginPwd&quot;</span>,loginPwd);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> userLoginInfo;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"7.控制查询结果的升降序\">7.控制查询结果的升降序<a title=\"#7.控制查询结果的升降序\" href=\"#7.控制查询结果的升降序\"></a></h2>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Scanner;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2020/11/30</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCTest08</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 用户在控制台输入desc就是降序，输入asc就是升序</span></span><br><span class=\"line\">        Scanner s = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;输入desc或asc,desc表示降序，asc表示升序&quot;</span>);</span><br><span class=\"line\">        System.out.print(<span class=\"string\">&quot;请输入： &quot;</span>);</span><br><span class=\"line\">        String keyWorld = s.nextLine();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 执行SQL</span></span><br><span class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        Statement stmt = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        ResultSet rs = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 注册驱动</span></span><br><span class=\"line\">            Class.forName(<span class=\"string\">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 建立连接</span></span><br><span class=\"line\">            conn = DriverManager.getConnection(<span class=\"string\">&quot;jdbc:mysql://127.0.0.1:3306/bjpowernode&quot;</span>,<span class=\"string\">&quot;root&quot;</span>,<span class=\"string\">&quot;991229&quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 获取操作对象</span></span><br><span class=\"line\">            stmt = conn.createStatement();</span><br><span class=\"line\">            <span class=\"comment\">// 执行操作</span></span><br><span class=\"line\">            String sql = <span class=\"string\">&quot;select ename from emp order by ename &quot;</span> + keyWorld;</span><br><span class=\"line\">            rs = stmt.executeQuery(sql);</span><br><span class=\"line\">            <span class=\"comment\">// 遍历结果集</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(rs.next())&#123;</span><br><span class=\"line\">                System.out.println(rs.getString(<span class=\"string\">&quot;ename&quot;</span>));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(rs != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    rs.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(stmt != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    stmt.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(conn != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    conn.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"8.-preparedstatement-完成-insert-delete-update，模糊查询\">8. PreparedStatement 完成 INSERT DELETE UPDATE，模糊查询<a title=\"#8.-preparedstatement-完成-insert-delete-update，模糊查询\" href=\"#8.-preparedstatement-完成-insert-delete-update，模糊查询\"></a></h2>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.DriverManager;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.PreparedStatement;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2020/11/30</span></span><br><span class=\"line\"><span class=\"comment\"> * PreparedStatement 完成 INSERT DELETE UPDATE</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCTest09</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        PreparedStatement ps = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">            Class.forName(<span class=\"string\">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class=\"line\">            conn = DriverManager.getConnection(<span class=\"string\">&quot;jdbc:mysql://127.0.0.1:3306/bjpowernode&quot;</span>,<span class=\"string\">&quot;root&quot;</span>,<span class=\"string\">&quot;991229&quot;</span>);</span><br><span class=\"line\">            <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">            String sql = &quot;insert into dept(deptno,dname,loc) value (?,?,?)&quot;;</span></span><br><span class=\"line\"><span class=\"comment\">            ps = conn.prepareStatement(sql);</span></span><br><span class=\"line\"><span class=\"comment\">            ps.setInt(1,60);</span></span><br><span class=\"line\"><span class=\"comment\">            ps.setString(2,&quot;销售部&quot;);</span></span><br><span class=\"line\"><span class=\"comment\">            ps.setString(3,&quot;上海&quot;);</span></span><br><span class=\"line\"><span class=\"comment\">            */</span></span><br><span class=\"line\">            <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">            String sql = &quot;UPDATE dept set dname = ? ,loc = ? where deptno = ?&quot;;</span></span><br><span class=\"line\"><span class=\"comment\">            ps = conn.prepareStatement(sql);</span></span><br><span class=\"line\"><span class=\"comment\">            ps.setString(1,&quot;研发一部&quot;);</span></span><br><span class=\"line\"><span class=\"comment\">            ps.setString(2,&quot;北京&quot;);</span></span><br><span class=\"line\"><span class=\"comment\">            ps.setInt(3,60);</span></span><br><span class=\"line\"><span class=\"comment\">            */</span></span><br><span class=\"line\"></span><br><span class=\"line\">            String sql = <span class=\"string\">&quot;DELETE from dept where deptno = ?&quot;</span>;</span><br><span class=\"line\">            ps = conn.prepareStatement(sql);</span><br><span class=\"line\">            ps.setInt(<span class=\"number\">1</span>,<span class=\"number\">60</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">int</span> count = ps.executeUpdate();</span><br><span class=\"line\">            System.out.print(count);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(ps != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    ps.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(conn != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    conn.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.bjpowernode.jdbc.utils.DBUtil;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.PreparedStatement;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.ResultSet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2020/12/1</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCTest12</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        PreparedStatement ps = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        ResultSet rs = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            conn =  DBUtil.getConnection();</span><br><span class=\"line\"></span><br><span class=\"line\">            String sql = <span class=\"string\">&quot;select ename from emp where ename like ?&quot;</span>;</span><br><span class=\"line\">            ps = conn.prepareStatement(sql);</span><br><span class=\"line\">            ps.setString(<span class=\"number\">1</span>,<span class=\"string\">&quot;_A%&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            rs = ps.executeQuery();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(rs.next())&#123;</span><br><span class=\"line\">                System.out.println(rs.getString(<span class=\"string\">&quot;ename&quot;</span>));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SQLException throwables) &#123;</span><br><span class=\"line\">            throwables.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"9.mysql的事务机制\">9.mysql的事务机制<a title=\"#9.mysql的事务机制\" href=\"#9.mysql的事务机制\"></a></h2>\n<h3 id=\"9.1-默认自动提交\">9.1 默认自动提交<a title=\"#9.1-默认自动提交\" href=\"#9.1-默认自动提交\"></a></h3>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.DriverManager;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.PreparedStatement;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2020/11/30</span></span><br><span class=\"line\"><span class=\"comment\"> * JDBC事物机制：</span></span><br><span class=\"line\"><span class=\"comment\"> *      1.JDBC中的事物是自动提交的，什么是自动提交？</span></span><br><span class=\"line\"><span class=\"comment\"> *          只要执行任意一条DML语句，则自动提交一次。这是JDBC默认的事物行为</span></span><br><span class=\"line\"><span class=\"comment\"> *          但是在实际事物中，通常都是N条DML语句共同联合才能完成，必须保证他们这些DML语句在同一个事物中，</span></span><br><span class=\"line\"><span class=\"comment\"> *          同时成功或者同时失败。</span></span><br><span class=\"line\"><span class=\"comment\"> *      2.以下程序先来验证一下JDBC事物是否是自动提交机制</span></span><br><span class=\"line\"><span class=\"comment\"> *          测试结果，只要自动执行一条DML语句，就执行一次</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCTest10</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        PreparedStatement ps = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">            Class.forName(<span class=\"string\">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class=\"line\">            conn = DriverManager.getConnection(<span class=\"string\">&quot;jdbc:mysql://127.0.0.1:3306/bjpowernode&quot;</span>,<span class=\"string\">&quot;root&quot;</span>,<span class=\"string\">&quot;991229&quot;</span>);</span><br><span class=\"line\">            String sql = <span class=\"string\">&quot;update dept set dname = ? where deptno = ?&quot;</span>;</span><br><span class=\"line\">            ps = conn.prepareStatement(sql);</span><br><span class=\"line\">            ps.setString(<span class=\"number\">1</span>,<span class=\"string\">&quot;X部门&quot;</span>);</span><br><span class=\"line\">            ps.setInt(<span class=\"number\">2</span>,<span class=\"number\">30</span>);</span><br><span class=\"line\">            <span class=\"keyword\">int</span> count = ps.executeUpdate(); <span class=\"comment\">//执行第一条sql语句</span></span><br><span class=\"line\">            System.out.println(count);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 重新给占位符传值</span></span><br><span class=\"line\">            ps.setString(<span class=\"number\">1</span>,<span class=\"string\">&quot;y部门&quot;</span>);</span><br><span class=\"line\">            ps.setInt(<span class=\"number\">2</span>,<span class=\"number\">20</span>);</span><br><span class=\"line\">            count = ps.executeUpdate(); <span class=\"comment\">//执行第二条sql语句</span></span><br><span class=\"line\">            System.out.println(count);</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (ClassNotFoundException | SQLException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(ps != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    ps.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(conn != <span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                    conn.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"9.2-实现事务的三行重要代码\">9.2 实现事务的三行重要代码<a title=\"#9.2-实现事务的三行重要代码\" href=\"#9.2-实现事务的三行重要代码\"></a></h3>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.DriverManager;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.PreparedStatement;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2020/12/1</span></span><br><span class=\"line\"><span class=\"comment\"> * sql脚本：</span></span><br><span class=\"line\"><span class=\"comment\"> *  drop table if exists t_act;</span></span><br><span class=\"line\"><span class=\"comment\"> *  create table t_act(</span></span><br><span class=\"line\"><span class=\"comment\"> *      actno bigint,</span></span><br><span class=\"line\"><span class=\"comment\"> *      balance double(7,2) //注意： 7表示有效数字的个数，2表示小数位的个数</span></span><br><span class=\"line\"><span class=\"comment\"> *  );</span></span><br><span class=\"line\"><span class=\"comment\"> *  insert into t_act(actno,balance) values(111,20000);</span></span><br><span class=\"line\"><span class=\"comment\"> *  insert into t_act(actno,balance) values(222,0);</span></span><br><span class=\"line\"><span class=\"comment\"> *  commit;</span></span><br><span class=\"line\"><span class=\"comment\"> *  select * from t_act;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> *  重点三行代码？</span></span><br><span class=\"line\"><span class=\"comment\"> *      conn.setAutoCommit(false);</span></span><br><span class=\"line\"><span class=\"comment\"> *      conn.commit();</span></span><br><span class=\"line\"><span class=\"comment\"> *      conn.rollback();</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCTest11</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        PreparedStatement ps = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 注册驱动</span></span><br><span class=\"line\">            Class.forName(<span class=\"string\">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 获取连接</span></span><br><span class=\"line\">            conn = DriverManager.getConnection(<span class=\"string\">&quot;jdbc:mysql://localhost:3306/mydatabase&quot;</span>,<span class=\"string\">&quot;root&quot;</span>,<span class=\"string\">&quot;146&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 将自动提交改为手动提交</span></span><br><span class=\"line\">            conn.setAutoCommit(<span class=\"keyword\">false</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 获取预编译的数据库操作对象</span></span><br><span class=\"line\">            String sql = <span class=\"string\">&quot;update t_act set balance = ? where actno = ? &quot;</span>;</span><br><span class=\"line\">            ps = conn.prepareStatement(sql);</span><br><span class=\"line\">            ps.setInt(<span class=\"number\">1</span>,<span class=\"number\">10000</span>);</span><br><span class=\"line\">            ps.setDouble(<span class=\"number\">2</span>,<span class=\"number\">111</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 执行sql语句</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> count = ps.executeUpdate();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">/*String s = null;</span></span><br><span class=\"line\"><span class=\"comment\">            s.toString();*/</span></span><br><span class=\"line\"></span><br><span class=\"line\">            ps.setInt(<span class=\"number\">1</span>,<span class=\"number\">10000</span>);</span><br><span class=\"line\">            ps.setDouble(<span class=\"number\">2</span>,<span class=\"number\">222</span>);</span><br><span class=\"line\">            count += ps.executeUpdate();</span><br><span class=\"line\"></span><br><span class=\"line\">            System.out.println(count == <span class=\"number\">2</span> ? <span class=\"string\">&quot;转账成功&quot;</span> : <span class=\"string\">&quot;转账失败&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 程序能执行到此处，说明没有异常，事务结束，手动提交数据</span></span><br><span class=\"line\">            conn.commit();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 遇到异常，回滚</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (conn != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    conn.rollback();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (SQLException throwables) &#123;</span><br><span class=\"line\">                    throwables.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;  <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 释放资源</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (ps != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    ps.close();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (SQLException throwables) &#123;</span><br><span class=\"line\">                    throwables.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (conn != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    conn.close();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (SQLException throwables) &#123;</span><br><span class=\"line\">                    throwables.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"9.3-事务实战\">9.3 事务实战<a title=\"#9.3-事务实战\" href=\"#9.3-事务实战\"></a></h3>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.bjpowernode.jdbc.utils.DBUtil;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.PreparedStatement;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.ResultSet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2020/12/1</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDBCTest13</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        PreparedStatement ps = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        ResultSet rs = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            conn = DBUtil.getConnection();</span><br><span class=\"line\">            <span class=\"comment\">// 开启事务</span></span><br><span class=\"line\">            conn.setAutoCommit(<span class=\"keyword\">false</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            ps = conn.prepareStatement(<span class=\"string\">&quot;select ename,job,sal from emp where job = ? for update &quot;</span>);</span><br><span class=\"line\">            ps.setString(<span class=\"number\">1</span>,<span class=\"string\">&quot;MANAGER&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            rs = ps.executeQuery();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">while</span>(rs.next()) &#123;</span><br><span class=\"line\">                System.out.println(rs.getString(<span class=\"string\">&quot;ename&quot;</span>) + <span class=\"string\">&quot;,&quot;</span> + rs.getString(<span class=\"string\">&quot;job&quot;</span>) + <span class=\"string\">&quot;,&quot;</span> + rs.getString(<span class=\"string\">&quot;sal&quot;</span>));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// 提交事务（事务结束）</span></span><br><span class=\"line\">            conn.commit();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SQLException throwables) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 回滚事务（事务结束）</span></span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                conn.rollback();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            throwables.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            DBUtil.close(conn,ps,rs);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"10.设计数据库工具类\">10.设计数据库工具类<a title=\"#10.设计数据库工具类\" href=\"#10.设计数据库工具类\"></a></h2>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc.utils;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.*;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2020/12/1</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * JDBC工具类，简化JDBC编程</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">    JDBC工具类，简化JDBC编程</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DBUtil</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 工具类中的构造方法是私有的</span></span><br><span class=\"line\"><span class=\"comment\">     * 因为工具类中的方法都是静态的，直接通过类名去调即可。</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">DBUtil</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 静态代码块，类加载的时候执行</span></span><br><span class=\"line\"><span class=\"comment\">     * 把注册驱动程序的代码放在静态代码块中，避免多次获取连接对象时重复调用</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Class.forName(<span class=\"string\">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (ClassNotFoundException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Connection <span class=\"title\">getConnection</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> SQLException </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> DriverManager.getConnection(<span class=\"string\">&quot;jdbc:mysql://localhost:3306/mydatabase&quot;</span>,<span class=\"string\">&quot;root&quot;</span>,<span class=\"string\">&quot;146&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">close</span><span class=\"params\">(Connection conn, Statement ps, ResultSet rs)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rs != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                rs.close();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException throwables) &#123;</span><br><span class=\"line\">                throwables.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ps != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                ps.close();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException throwables) &#123;</span><br><span class=\"line\">                throwables.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (conn != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                conn.close();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException throwables) &#123;</span><br><span class=\"line\">                throwables.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"11.-数据库连接池\">11. 数据库连接池<a title=\"#11.-数据库连接池\" href=\"#11.-数据库连接池\"></a></h2>\n<p>数据库连接 – 执行完毕 —释放</p>\n<p>连接 – 释放 十分浪费系统资源</p>\n<p><strong>池化技术：准备一些预先的资源，过来就连接预先准备好的</strong></p>\n<p>最小链接数：10</p>\n<p>最大连接数：100 业务最高承载上限</p>\n<p>等待超时：100ms</p>\n<p><strong>编写连接池，实现一个接口，DataSource</strong></p>\n<blockquote>\n<p>开源数据源实现</p>\n</blockquote>\n<p>DBCP</p>\n<p>C3P0</p>\n<p>Druid：阿里巴巴</p>\n<p>使用这些数据库连接池之后，我们在项目开发中就不需要编写连接数据库的代码了！</p>\n<ul>\n<li>下面编写测试使用的数据库</li>\n</ul>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> DATABASE jdbcStudy <span class=\"type\">CHARACTER</span> <span class=\"keyword\">SET</span> utf8 <span class=\"keyword\">COLLATE</span> utf8_general_ci;</span><br><span class=\"line\"></span><br><span class=\"line\">USE jdbcStudy;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> `users`(</span><br><span class=\"line\">\tid <span class=\"type\">INT</span> <span class=\"keyword\">PRIMARY</span> KEY,</span><br><span class=\"line\">\tNAME <span class=\"type\">VARCHAR</span>(<span class=\"number\">40</span>),</span><br><span class=\"line\">\tPASSWORD <span class=\"type\">VARCHAR</span>(<span class=\"number\">40</span>),</span><br><span class=\"line\">\temail <span class=\"type\">VARCHAR</span>(<span class=\"number\">60</span>),</span><br><span class=\"line\">\tbirthday <span class=\"type\">DATE</span></span><br><span class=\"line\">);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> `users`(id,NAME,PASSWORD,email,birthday)</span><br><span class=\"line\"><span class=\"keyword\">VALUES</span>(<span class=\"number\">1</span>,<span class=\"string\">&#x27;zhansan&#x27;</span>,<span class=\"string\">&#x27;123456&#x27;</span>,<span class=\"string\">&#x27;zs@sina.com&#x27;</span>,<span class=\"string\">&#x27;1980-12-04&#x27;</span>),</span><br><span class=\"line\">(<span class=\"number\">2</span>,<span class=\"string\">&#x27;lisi&#x27;</span>,<span class=\"string\">&#x27;123456&#x27;</span>,<span class=\"string\">&#x27;lisi@sina.com&#x27;</span>,<span class=\"string\">&#x27;1981-12-04&#x27;</span>),</span><br><span class=\"line\">(<span class=\"number\">3</span>,<span class=\"string\">&#x27;wangwu&#x27;</span>,<span class=\"string\">&#x27;123456&#x27;</span>,<span class=\"string\">&#x27;wangwu@sina.com&#x27;</span>,<span class=\"string\">&#x27;1979-12-04&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<ul>\n<li>DBCP</li>\n</ul>\n<p>需要用到的jar包</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- https://mvnrepository.com/artifact/commons-dbcp/commons-dbcp --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>commons-dbcp<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>commons-dbcp<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.4<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- https://mvnrepository.com/artifact/commons-pool/commons-pool --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>commons-pool<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>commons-pool<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.6<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>实现JdbcUtil_DBCP.java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc.utils;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.dbcp.BasicDataSourceFactory;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.sql.DataSource;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Properties;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2021/4/10</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JdbcUtil_DBCP</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">JdbcUtil_DBCP</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> DataSource dataSource = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            InputStream in = JdbcUtil_DBCP.class.getClassLoader().getResourceAsStream(<span class=\"string\">&quot;dbcpconfig.properties&quot;</span>);</span><br><span class=\"line\">            Properties properties = <span class=\"keyword\">new</span> Properties();</span><br><span class=\"line\">            properties.load(in);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//创建数据源:工厂模式 --&gt; 创建</span></span><br><span class=\"line\">            dataSource = BasicDataSourceFactory.createDataSource(properties);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Connection <span class=\"title\">getConnection</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> SQLException </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> dataSource.getConnection();  <span class=\"comment\">//从数据源中获取连接</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">close</span><span class=\"params\">(Connection conn, Statement ps, ResultSet rs)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rs != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                rs.close();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException throwables) &#123;</span><br><span class=\"line\">                throwables.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ps != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                ps.close();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException throwables) &#123;</span><br><span class=\"line\">                throwables.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (conn != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                conn.close();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException throwables) &#123;</span><br><span class=\"line\">                throwables.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>配置文件dbcpconfig.properties</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#连接设置</span></span><br><span class=\"line\"><span class=\"attr\">driverClassName</span>=<span class=\"string\">com.mysql.jdbc.Driver</span></span><br><span class=\"line\"><span class=\"attr\">url</span>=<span class=\"string\">jdbc:mysql://localhost:3306/jdbcStudy?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=true</span></span><br><span class=\"line\"><span class=\"attr\">username</span>=<span class=\"string\">root</span></span><br><span class=\"line\"><span class=\"attr\">password</span>=<span class=\"string\">991229</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">#&lt;!-- 初始化连接 --&gt;</span></span><br><span class=\"line\"><span class=\"attr\">initialSize</span>=<span class=\"string\">10</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">#最大连接数量</span></span><br><span class=\"line\"><span class=\"attr\">maxActive</span>=<span class=\"string\">50</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">#&lt;!-- 最大空闲连接 --&gt;</span></span><br><span class=\"line\"><span class=\"attr\">maxIdle</span>=<span class=\"string\">20</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">#&lt;!-- 最小空闲连接 --&gt;</span></span><br><span class=\"line\"><span class=\"attr\">minIdle</span>=<span class=\"string\">5</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">#&lt;!-- 超时等待时间以毫秒为单位 6000毫秒/1000等于60秒 --&gt;</span></span><br><span class=\"line\"><span class=\"attr\">maxWait</span>=<span class=\"string\">60000</span></span><br><span class=\"line\"><span class=\"comment\">#JDBC驱动建立连接时附带的连接属性属性的格式必须为这样：【属性名=property;】</span></span><br><span class=\"line\"><span class=\"comment\">#注意：&quot;user&quot; 与 &quot;password&quot; 两个属性会被明确地传递，因此这里不需要包含他们。</span></span><br><span class=\"line\"><span class=\"attr\">connectionProperties</span>=<span class=\"string\">useUnicode=true;characterEncoding=UTF8</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">#指定由连接池所创建的连接的自动提交（auto-commit）状态。</span></span><br><span class=\"line\"><span class=\"attr\">defaultAutoCommit</span>=<span class=\"string\">true</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">#driver default 指定由连接池所创建的连接的只读（read-only）状态。</span></span><br><span class=\"line\"><span class=\"comment\">#如果没有设置该值，则“setReadOnly”方法将不被调用。（某些驱动并不支持只读模式，如：Informix）</span></span><br><span class=\"line\"><span class=\"attr\">defaultReadOnly</span>=<span class=\"string\"></span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">#driver default 指定由连接池所创建的连接的事务级别（TransactionIsolation）。</span></span><br><span class=\"line\"><span class=\"comment\">#可用值为下列之一：（详情可见javadoc。）NONE,READ_UNCOMMITTED, READ_COMMITTED, REPEATABLE_READ, SERIALIZABLE</span></span><br><span class=\"line\"><span class=\"attr\">defaultTransactionIsolation</span>=<span class=\"string\">READ_UNCOMMITTED</span></span><br></pre></td></tr></table></figure>\n<p>测试程序</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.bjpowernode.jdbc.utils.JdbcUtil_DBCP;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.PreparedStatement;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2021/4/10</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestDBCP</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        PreparedStatement st = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            conn = JdbcUtil_DBCP.getConnection();</span><br><span class=\"line\">            String sql = <span class=\"string\">&quot;insert into users(id,NAME,PASSWORD,email,birthday)values(?,?,?,?,?)&quot;</span>;</span><br><span class=\"line\">            st = conn.prepareStatement(sql);</span><br><span class=\"line\"></span><br><span class=\"line\">            st.setInt(<span class=\"number\">1</span>,<span class=\"number\">6</span>);</span><br><span class=\"line\">            st.setString(<span class=\"number\">2</span>,<span class=\"string\">&quot;qinjiang&quot;</span>);</span><br><span class=\"line\">            st.setString(<span class=\"number\">3</span>,<span class=\"string\">&quot;1232112&quot;</span>);</span><br><span class=\"line\">            st.setString(<span class=\"number\">4</span>,<span class=\"string\">&quot;24@qq.com&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            st.setDate(<span class=\"number\">5</span>, <span class=\"keyword\">new</span> java.sql.Date(<span class=\"keyword\">new</span> Date().getTime()));</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">int</span> i = st.executeUpdate();</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(i&gt;<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;插入成功！&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;<span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            JdbcUtil_DBCP.close(conn,st,<span class=\"keyword\">null</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>C3P0</li>\n</ul>\n<p>需要用到的jar包</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- https://mvnrepository.com/artifact/com.mchange/c3p0 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.mchange<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>c3p0<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.9.5.5<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- https://mvnrepository.com/artifact/com.mchange/mchange-commons-java --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.mchange<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mchange-commons-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.2.19<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>实现JdbcUtil_C3P0.java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc.utils;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.commons.dbcp.BasicDataSourceFactory;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.sql.DataSource;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.ResultSet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Statement;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Properties;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2021/4/11</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JdbcUtil_C3P0</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">JdbcUtil_C3P0</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> ComboPooledDataSource dataSource = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 代码版配置</span></span><br><span class=\"line\"><span class=\"comment\">//            dataSource = new ComboPooledDataSource();</span></span><br><span class=\"line\"><span class=\"comment\">//            dataSource.setDriverClass();</span></span><br><span class=\"line\"><span class=\"comment\">//            dataSource.setUser();</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//创建数据源:工厂模式 --&gt; 创建</span></span><br><span class=\"line\">            dataSource = <span class=\"keyword\">new</span> ComboPooledDataSource(<span class=\"string\">&quot;MySQL&quot;</span>);    <span class=\"comment\">//配置文件写法</span></span><br><span class=\"line\"></span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Connection <span class=\"title\">getConnection</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> SQLException </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> dataSource.getConnection();  <span class=\"comment\">//从数据源中获取连接</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">close</span><span class=\"params\">(Connection conn, Statement ps, ResultSet rs)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rs != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                rs.close();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException throwables) &#123;</span><br><span class=\"line\">                throwables.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ps != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                ps.close();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException throwables) &#123;</span><br><span class=\"line\">                throwables.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (conn != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                conn.close();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SQLException throwables) &#123;</span><br><span class=\"line\">                throwables.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>配置文件 c3p0-config.xml</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">c3p0-config</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--</span></span><br><span class=\"line\"><span class=\"comment\">    c3p0的缺省（默认）配置</span></span><br><span class=\"line\"><span class=\"comment\">    如果在代码中&quot;ComboPooledDataSource ds=new ComboPooledDataSource();&quot;这样写就表示使用的是c3p0的缺省（默认）</span></span><br><span class=\"line\"><span class=\"comment\">    --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">default-config</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;driverClass&quot;</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;jdbcUrl&quot;</span>&gt;</span>jdbc:mysql://localhost:3306/jdbcStudy<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;user&quot;</span>&gt;</span>root<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;password&quot;</span>&gt;</span>123456<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;acquiredIncrement&quot;</span>&gt;</span>5<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;initialPoolSize&quot;</span>&gt;</span>10<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;minPoolSize&quot;</span>&gt;</span>5<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;maxPoolSize&quot;</span>&gt;</span>20<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">default-config</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--</span></span><br><span class=\"line\"><span class=\"comment\">    C3P0的命名配置，</span></span><br><span class=\"line\"><span class=\"comment\">    如果在代码中&quot;ComboPooledDataSource ds = new ComboPooledDataSource(&quot;MySQL&quot;);&quot;这样写就表示使用的是name是MySQL的配置</span></span><br><span class=\"line\"><span class=\"comment\">    --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">named-config</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;MySQL&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;driverClass&quot;</span>&gt;</span>com.mysql.jdbc.Driver<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;jdbcUrl&quot;</span>&gt;</span>jdbc:mysql://localhost:3306/jdbcStudy<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;user&quot;</span>&gt;</span>root<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;password&quot;</span>&gt;</span>991229<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;acquiredIncrement&quot;</span>&gt;</span>5<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;initialPoolSize&quot;</span>&gt;</span>10<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;minPoolSize&quot;</span>&gt;</span>5<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;maxPoolSize&quot;</span>&gt;</span>20<span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">named-config</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">c3p0-config</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>测试程序：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.bjpowernode.jdbc;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.bjpowernode.jdbc.utils.JdbcUtil_C3P0;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.bjpowernode.jdbc.utils.JdbcUtil_DBCP;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.Connection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.PreparedStatement;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.sql.SQLException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Create By JD</span></span><br><span class=\"line\"><span class=\"comment\"> * Created by JBuck on 2021/4/11</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestC3P0</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Connection conn = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        PreparedStatement st = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            conn = JdbcUtil_C3P0.getConnection();</span><br><span class=\"line\">            String sql = <span class=\"string\">&quot;insert into users(id,NAME,PASSWORD,email,birthday)values(?,?,?,?,?)&quot;</span>;</span><br><span class=\"line\">            st = conn.prepareStatement(sql);</span><br><span class=\"line\"></span><br><span class=\"line\">            st.setInt(<span class=\"number\">1</span>,<span class=\"number\">5</span>);</span><br><span class=\"line\">            st.setString(<span class=\"number\">2</span>,<span class=\"string\">&quot;qinjiang&quot;</span>);</span><br><span class=\"line\">            st.setString(<span class=\"number\">3</span>,<span class=\"string\">&quot;1232112&quot;</span>);</span><br><span class=\"line\">            st.setString(<span class=\"number\">4</span>,<span class=\"string\">&quot;24@qq.com&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            st.setDate(<span class=\"number\">5</span>, <span class=\"keyword\">new</span> java.sql.Date(<span class=\"keyword\">new</span> Date().getTime()));</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">int</span> i = st.executeUpdate();</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(i&gt;<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;插入成功！&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (SQLException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;<span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            JdbcUtil_DBCP.close(conn,st,<span class=\"keyword\">null</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>结论：无论使用什么数据源，本质还是一样的,DataSource接口不会变，方法就不会变</p>\n","next":{"title":"MySQL笔记","link":"2021/06/08/MySQL笔记"},"plink":"https://47.115.211.244/blog/2021/06/08/JDBC基础知识/","toc":[{"id":"1.-jdbc使用方法六步","title":"1. JDBC使用方法六步","index":"1"},{"id":"2.实现注册的另一个方法","title":"2.实现注册的另一个方法","index":"2"},{"id":"3.将连接数据库的所有信息都配置到配置文件中","title":"3.将连接数据库的所有信息都配置到配置文件中","index":"3"},{"id":"4.-查询数据库数据","title":"4. 查询数据库数据","index":"4"},{"id":"5.mysql注入问题","title":"5.Mysql注入问题","index":"5"},{"id":"6.-解决mysql注入问题,preparestatement","title":"6. 解决mysql注入问题,prepareStatement","index":"6"},{"id":"7.控制查询结果的升降序","title":"7.控制查询结果的升降序","index":"7"},{"id":"8.-preparedstatement-完成-insert-delete-update，模糊查询","title":"8. PreparedStatement 完成 INSERT DELETE UPDATE，模糊查询","index":"8"},{"id":"9.mysql的事务机制","title":"9.mysql的事务机制","index":"9","children":[{"id":"9.1-默认自动提交","title":"9.1 默认自动提交","index":"9.1"},{"id":"9.2-实现事务的三行重要代码","title":"9.2 实现事务的三行重要代码","index":"9.2"},{"id":"9.3-事务实战","title":"9.3 事务实战","index":"9.3"}]},{"id":"10.设计数据库工具类","title":"10.设计数据库工具类","index":"10"},{"id":"11.-数据库连接池","title":"11. 数据库连接池","index":"11"}],"copyright":{"author":"JNbuck","link":"<a href=\"https://47.115.211.244/blog/2021/06/08/JDBC基础知识/\" title=\"JDBC基础知识\">https://47.115.211.244/blog/2021/06/08/JDBC基础知识/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow noopener\" target=\"_blank\">CC BY-NC-ND 4.0</a>)"},"reading_time":"7387 words in 49 min"}